(this.webpackJsonpitem_manager=this.webpackJsonpitem_manager||[]).push([[0],{28:function(e,t,n){},38:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},40:function(e,t,n){e.exports=n(69)},50:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(17),u=n.n(c),o=n(15),l=n(3),i=(n(28),n(2)),s=n.n(i),m=n(6),d=n(38),p=n.n(d),f=(n(50),n(22)),v=n(11),g=n(25),E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_ITEMS":return t.data;case"UPDATE":var n=e.filter((function(e){return e.id!==t.data.id})),a=t.data;return[].concat(Object(g.a)(n),[a]);case"REMOVE":var r=e.filter((function(e){return e.id!==t.data.id}));return r;case"ADD_NEW":var c=t.data;return[].concat(Object(g.a)(e),[c]);default:return e}},b=function(e){return{type:"LOGIN",data:e}},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:JSON.parse(localStorage.getItem("loggedUser")),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return t.data;case"LOGOUT":return null;default:return e}},y=n(12),O=n.n(y),w="/api/items",j=null,k={getAll:function(){var e=Object(m.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get(w);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post(w,t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return O.a.put("".concat(w,"/").concat(e),t).then((function(e){return e.data}))},remove:function(e){var t={headers:{Authorization:j}};return O.a.delete("".concat(w,"/").concat(e),t)},updateUse:function(){var e=Object(m.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("".concat(w,"/").concat(t,"/use"),n);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),setToken:function(e){j="bearer ".concat(e)}},x=function(e){var t=e.item;if(null===t||void 0===t||void 0===t.use)return r.a.createElement("div",null);var n=0===t.use.length?0:t.use.map((function(e){return e.amount})).reduce((function(e,t){return e+t}));return r.a.createElement("div",null,r.a.createElement("h2",null,t.name),r.a.createElement("div",null,r.a.createElement("p",null,"In total you have used this item for ",r.a.createElement("a",null,n," ",t.units))))},S=n(10),I=function(e){var t=Object(l.b)(),n=e.item,c=Object(a.useState)(!0),u=Object(S.a)(c,2),o=u[0],i=u[1],s={display:o?"none":""};var m=0===n.use.length?0:n.use.map((function(e){return e.amount})).reduce((function(e,t){return e+t})),d=0===n.use.length?"This item hasn't been used":"previously used ".concat(function(e){var t=e.split("T");return t[1]=t[1].split(".")[0],t}(n.use[n.use.length-1].date)[0]);return r.a.createElement("div",{onClick:function(){i(!o)}},r.a.createElement("div",{className:"list-item-mini-info"},r.a.createElement("p",{style:{marginBottom:2,cursor:"pointer"}},e.item.name)),r.a.createElement("div",{className:"list-item-detail-info",style:s},r.a.createElement("p",{style:{fontSize:13,marginBottom:1,marginTop:1}},d),r.a.createElement("p",{style:{fontSize:13,marginBottom:1,marginTop:1}},"in total used for ",m," ",n.units),r.a.createElement("p",null,r.a.createElement("a",{style:{backgroundColor:"grey",color:"white",textDecoration:"none",borderRadius:5,fontSize:18,padding:6,cursor:"pointer"},href:"/items/".concat(n.id)},"Show more")),r.a.createElement("p",{style:{fontSize:15,marginBottom:2}},"log new use"),n.common_usecases.map((function(e){return r.a.createElement("button",{key:e,className:"usecase-log-button",onClick:function(){return function(e,n){console.log(e),console.log(n);var a={date:(new Date).toISOString(),amount:Number(n)};window.confirm("Add ".concat(n).concat(e.units," for ").concat(e.name,"?"))?k.updateUse(e.id,a).then((function(e){return t(function(e,t){return{type:"UPDATE",data:e}}(e))})):console.log("nothing added")}(n,e)}},e," ",n.units)}))))},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE":return t.data;default:return e}},N=function(e){var t=Object(l.b)();return r.a.createElement("div",null,r.a.createElement("p",null,"Filter items by their name"),r.a.createElement("input",{onChange:function(e){e.preventDefault();var n=e.target.value;t({type:"CHANGE",data:n})}}))},A=function(){var e=Object(l.c)((function(e){return e.visibilityFilter})),t=Object(l.c)((function(e){return e.items}));console.log(t);var n=Object(l.c)((function(e){return e.loggedUser}));if(void 0===n||null===n)return r.a.createElement("div",null,r.a.createElement("p",null,"Log in to enjoy this application."));if(void 0===t||null===t)return r.a.createElement("div",null);var a=t.filter((function(t){return-1!==t.name.toLowerCase().indexOf(e.toLowerCase())})).sort((function(e,t){return e.name.toLowerCase()>=t.name.toLowerCase()?1:-1}));return r.a.createElement("div",null,r.a.createElement(N,null),r.a.createElement("h2",null,"Items"),a.map((function(e){return r.a.createElement(I,{key:e.id,item:e})})))},T=function(e){var t=Object(l.b)(),n=Object(a.useState)(!1),c=Object(S.a)(n,2),u=c[0],o=c[1],i=Object(a.useState)(""),d=Object(S.a)(i,2),p=d[0],f=d[1],v=Object(a.useState)([]),g=Object(S.a)(v,2),E=g[0],b=g[1],h=Object(a.useState)(""),y=Object(S.a)(h,2),O=y[0],w=y[1];var j=function(){var e=Object(m.a)(s.a.mark((function e(n){var a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{n.preventDefault(),a={name:n.target.name.value,units:n.target.units.value,use:[],common_usecases:E},k.create(a).then((function(e){return t({type:"ADD_NEW",data:e})})),n.target.name.value="",n.target.units.value="",w(""),b([])}catch(c){r="couldn't add new item due to an error: ".concat(c),alert(r)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x={display:u?"":"none"},I={display:0===E.length?"none":""},C={display:""===O?"none":"",backgroundColor:"coral",padding:5,borderRadius:5,cursor:"pointer"},N={display:E.length>0?"":"none",backgroundColor:"teal",color:"white",padding:5,borderRadius:5,cursor:"pointer"};return r.a.createElement("div",null,r.a.createElement("div",{onClick:function(){o(!u)},style:{cursor:"pointer"}},r.a.createElement("h3",null,"Add new item")),r.a.createElement("div",{style:x},r.a.createElement("form",{onSubmit:j},"name: \u2003",r.a.createElement("input",{type:"text",name:"name"}),r.a.createElement("br",null),r.a.createElement("br",null),"What do you measure?",r.a.createElement("br",null),r.a.createElement("input",{onChange:function(e){var t=e.target;return f(t.value)},type:"radio",id:"km",name:"units",value:"km"}),"distance \xa0",r.a.createElement("input",{onChange:function(e){var t=e.target;return f(t.value)},type:"radio",id:"h",name:"units",value:"h"}),"time",r.a.createElement("br",null),r.a.createElement("br",null),"Add common usecases for the item",r.a.createElement("br",null),r.a.createElement("input",{onChange:function(e){var t=e.target;return w(t.value)},type:"number",value:O}),r.a.createElement("p",null,r.a.createElement("a",{style:C,onClick:function(e){var t=function(e){var t=parseInt(e);return!parseInt(t)&0!==parseInt(t)?"only numbers!":E.indexOf(t)>=0?"You have already added this usecase!":t<=0?"Only positive values to usecases":"no errors"}(O);"no errors"===t?(b(E.concat(parseInt(O))),w("")):(console.log("".concat(t)),w(""))}},"Add")),r.a.createElement("p",{style:I},"[",E.map((function(e){return r.a.createElement("a",null," ",e,p," ")})),"] \u2003 ",r.a.createElement("a",{style:N,onClick:function(){b([])}}," clear ")," "),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("button",null,"Add a new item"),r.a.createElement("br",null),r.a.createElement("br",null))))},L={login:function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getLoginInfo:function(){var e=Object(m.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,localStorage.getItem("loggedUser");case 2:return t=e.sent,e.next=5,JSON.parse(t);case 5:return n=e.sent,console.log(n),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},U=function(e){var t=Object(l.b)(),n=Object(a.useState)(!1),c=Object(S.a)(n,2),u=(c[0],c[1],function(){var e=Object(m.a)(s.a.mark((function e(n){var a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,L.login({username:n.target.username.value,password:n.target.password.value});case 4:return a=e.sent,window.localStorage.setItem("loggedUser",JSON.stringify(a)),e.next=8,k.setToken(a.token);case 8:r="Succesfully logged in as ".concat(a.name),t(b(a)),console.log(r),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),"username or password was incorrect",console.log("username or password was incorrect");case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}());return r.a.createElement("div",null,r.a.createElement("h2",null,"Log in"),r.a.createElement("form",{onSubmit:u},r.a.createElement("div",null,"username \xa0",r.a.createElement("input",{type:"text",name:"username"})),r.a.createElement("div",null,"password \xa0",r.a.createElement("input",{type:"password",name:"password"})),r.a.createElement("button",{style:{marginTop:"5px"}},"log in")))},D=function(){var e=Object(l.b)();Object(a.useEffect)((function(){k.getAll().then((function(t){return e(function(e){return{type:"INIT_ITEMS",data:e}}(t))}))}),[e]);var t=Object(l.c)((function(e){return e.items})),n=Object(l.c)((function(e){return e.loggedUser})),c=function(){var e={display:null===n?"none":"",backgroundColor:"darkGrey",color:"black",padding:5,borderRadius:5,cursor:"pointer",marginLeft:"45%",marginRight:"5%"};return r.a.createElement("div",null,r.a.createElement("p",{style:{marginLeft:"auto",marginRight:"auto"}},"Logged in as ",n.name," ",r.a.createElement("a",{style:e,onClick:u},"logout")))},u=function(){var t=Object(m.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.setToken(null);case 2:return t.next=4,localStorage.removeItem("loggedUser");case 4:e({type:"LOGOUT"});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("div",{className:"App"},r.a.createElement(f.a,null,r.a.createElement("header",{className:"App-header"},r.a.createElement(f.b,{exact:!0,to:"/"},r.a.createElement("img",{src:p.a,className:"App-logo",alt:"logo"}))),r.a.createElement("div",null,null!==n&&r.a.createElement(c,null),(void 0===n||null===n)&&r.a.createElement(U,null),r.a.createElement(v.a,{exact:!0,path:"/",render:function(){return r.a.createElement(A,null)}}),r.a.createElement(v.a,{exact:!0,path:"/items/:id",render:function(e){var n,a=e.match;return r.a.createElement(x,{key:a.params.id,item:(n=a.params.id,void t.find((function(e){return e.id===n})))})}}),null!==n&&r.a.createElement(T,null))))},_=Object(o.b)({items:E,loggedUser:h,visibilityFilter:C}),G=Object(o.c)(_);u.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(l.a,{store:G},r.a.createElement(D,null))),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.cb9659ca.chunk.js.map